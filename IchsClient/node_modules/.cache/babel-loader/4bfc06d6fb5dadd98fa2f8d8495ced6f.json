{"ast":null,"code":"'use client';\n\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/esm/taggedTemplateLiteralLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _templateObject;\nvar _excluded = [\"as\", \"appearance\", \"data\", \"valueKey\", \"labelKey\", \"value\", \"classPrefix\", \"placeholder\", \"defaultValue\", \"disabled\", \"cleanable\", \"placement\", \"menuClassName\", \"menuAutoWidth\", \"menuMaxHeight\", \"menuStyle\", \"groupBy\", \"locale\", \"toggleAs\", \"style\", \"searchable\", \"disabledItemValues\", \"virtualized\", \"listProps\", \"id\", \"onGroupTitleClick\", \"searchBy\", \"onEntered\", \"onExited\", \"onClean\", \"onChange\", \"onSelect\", \"onSearch\", \"sort\", \"renderValue\", \"renderMenu\", \"renderMenuGroup\", \"renderMenuItem\", \"renderExtraFooter\"];\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport pick from 'lodash/pick';\nimport isNil from 'lodash/isNil';\nimport isFunction from 'lodash/isFunction';\nimport omit from 'lodash/omit';\nimport { useCustom, useClassNames, useControlled, useEventCallback } from \"../internals/hooks/index.js\";\nimport { createChainedFunction, mergeRefs, shallowEqual, getDataGroupBy } from \"../internals/utils/index.js\";\nimport { Listbox, ListItem, PickerToggle, PickerToggleTrigger, PickerPopup, useFocusItemValue, usePickerClassName, useSearch, useToggleKeyDownEvent, usePickerRef, pickTriggerPropKeys, omitTriggerPropKeys, listPickerPropTypes } from \"../internals/Picker/index.js\";\nimport SearchBox from \"../internals/SearchBox/index.js\";\nimport { oneOf } from \"../internals/propTypes/index.js\";\nvar emptyArray = [];\n/**\n * The `SelectPicker` component is used to select an item from a list of data.\n * @see https://rsuitejs.com/components/select-picker/\n */\nvar SelectPicker = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$as = props.as,\n    Component = _props$as === void 0 ? 'div' : _props$as,\n    _props$appearance = props.appearance,\n    appearance = _props$appearance === void 0 ? 'default' : _props$appearance,\n    _props$data = props.data,\n    data = _props$data === void 0 ? emptyArray : _props$data,\n    _props$valueKey = props.valueKey,\n    valueKey = _props$valueKey === void 0 ? 'value' : _props$valueKey,\n    _props$labelKey = props.labelKey,\n    labelKey = _props$labelKey === void 0 ? 'label' : _props$labelKey,\n    valueProp = props.value,\n    _props$classPrefix = props.classPrefix,\n    classPrefix = _props$classPrefix === void 0 ? 'picker' : _props$classPrefix,\n    placeholder = props.placeholder,\n    defaultValue = props.defaultValue,\n    disabled = props.disabled,\n    _props$cleanable = props.cleanable,\n    cleanable = _props$cleanable === void 0 ? true : _props$cleanable,\n    _props$placement = props.placement,\n    placement = _props$placement === void 0 ? 'bottomStart' : _props$placement,\n    menuClassName = props.menuClassName,\n    _props$menuAutoWidth = props.menuAutoWidth,\n    menuAutoWidth = _props$menuAutoWidth === void 0 ? true : _props$menuAutoWidth,\n    _props$menuMaxHeight = props.menuMaxHeight,\n    menuMaxHeight = _props$menuMaxHeight === void 0 ? 320 : _props$menuMaxHeight,\n    menuStyle = props.menuStyle,\n    groupBy = props.groupBy,\n    overrideLocale = props.locale,\n    toggleAs = props.toggleAs,\n    style = props.style,\n    _props$searchable = props.searchable,\n    searchable = _props$searchable === void 0 ? true : _props$searchable,\n    _props$disabledItemVa = props.disabledItemValues,\n    disabledItemValues = _props$disabledItemVa === void 0 ? emptyArray : _props$disabledItemVa,\n    virtualized = props.virtualized,\n    listProps = props.listProps,\n    id = props.id,\n    onGroupTitleClick = props.onGroupTitleClick,\n    searchBy = props.searchBy,\n    onEntered = props.onEntered,\n    onExited = props.onExited,\n    onClean = props.onClean,\n    onChange = props.onChange,\n    onSelect = props.onSelect,\n    onSearch = props.onSearch,\n    sort = props.sort,\n    renderValue = props.renderValue,\n    renderMenu = props.renderMenu,\n    renderMenuGroup = props.renderMenuGroup,\n    renderMenuItem = props.renderMenuItem,\n    renderExtraFooter = props.renderExtraFooter,\n    rest = _objectWithoutPropertiesLoose(props, _excluded);\n  var _usePickerRef = usePickerRef(ref),\n    trigger = _usePickerRef.trigger,\n    root = _usePickerRef.root,\n    target = _usePickerRef.target,\n    overlay = _usePickerRef.overlay,\n    list = _usePickerRef.list,\n    searchInput = _usePickerRef.searchInput;\n  var _useCustom = useCustom('Picker', overrideLocale),\n    locale = _useCustom.locale;\n  var _ref = useControlled(valueProp, defaultValue),\n    value = _ref[0],\n    setValue = _ref[1];\n\n  // Used to hover the focus item  when trigger `onKeydown`\n  var _useFocusItemValue = useFocusItemValue(value, {\n      data: data,\n      valueKey: valueKey,\n      target: function target() {\n        return overlay.current;\n      }\n    }),\n    focusItemValue = _useFocusItemValue.focusItemValue,\n    setFocusItemValue = _useFocusItemValue.setFocusItemValue,\n    onFocusItem = _useFocusItemValue.onKeyDown;\n\n  // Use search keywords to filter options.\n  var _useSearch = useSearch(data, {\n      labelKey: labelKey,\n      searchBy: searchBy,\n      callback: function callback(searchKeyword, filteredData, event) {\n        var _filteredData$;\n        // The first option after filtering is the focus.\n        setFocusItemValue(filteredData === null || filteredData === void 0 ? void 0 : (_filteredData$ = filteredData[0]) === null || _filteredData$ === void 0 ? void 0 : _filteredData$[valueKey]);\n        onSearch === null || onSearch === void 0 ? void 0 : onSearch(searchKeyword, event);\n      }\n    }),\n    searchKeyword = _useSearch.searchKeyword,\n    filteredData = _useSearch.filteredData,\n    resetSearch = _useSearch.resetSearch,\n    handleSearch = _useSearch.handleSearch;\n\n  // Use component active state to support keyboard events.\n  var _useState = useState(false),\n    active = _useState[0],\n    setActive = _useState[1];\n  var handleClose = useEventCallback(function () {\n    var _trigger$current, _trigger$current$clos;\n    (_trigger$current = trigger.current) === null || _trigger$current === void 0 ? void 0 : (_trigger$current$clos = _trigger$current.close) === null || _trigger$current$clos === void 0 ? void 0 : _trigger$current$clos.call(_trigger$current);\n  });\n  var handleSelect = useEventCallback(function (value, item, event) {\n    var _target$current;\n    onSelect === null || onSelect === void 0 ? void 0 : onSelect(value, item, event);\n    (_target$current = target.current) === null || _target$current === void 0 ? void 0 : _target$current.focus();\n  });\n  var handleChangeValue = useEventCallback(function (value, event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n  });\n  var handleMenuPressEnter = useEventCallback(function (event) {\n    if (!focusItemValue) {\n      return;\n    }\n\n    // Find active `MenuItem` by `value`\n    var focusItem = data.find(function (item) {\n      return shallowEqual(item[valueKey], focusItemValue);\n    });\n    setValue(focusItemValue);\n    handleSelect(focusItemValue, focusItem, event);\n    handleChangeValue(focusItemValue, event);\n    handleClose();\n  });\n  var handleItemSelect = useEventCallback(function (value, item, event) {\n    setValue(value);\n    setFocusItemValue(value);\n    handleSelect(value, item, event);\n    handleChangeValue(value, event);\n    handleClose();\n  });\n  var handleClean = useEventCallback(function (event) {\n    if (disabled || !cleanable) {\n      return;\n    }\n    setValue(null);\n    setFocusItemValue(value);\n    handleChangeValue(null, event);\n  });\n  var onPickerKeyDown = useToggleKeyDownEvent(_extends({\n    toggle: !focusItemValue || !active,\n    trigger: trigger,\n    target: target,\n    overlay: overlay,\n    searchInput: searchInput,\n    active: active,\n    onExit: handleClean,\n    onMenuKeyDown: onFocusItem,\n    onMenuPressEnter: handleMenuPressEnter\n  }, rest));\n  var handleExited = useEventCallback(function () {\n    resetSearch();\n    setActive(false);\n    onSearch === null || onSearch === void 0 ? void 0 : onSearch('');\n    setFocusItemValue(null);\n  });\n  var handleEntered = useEventCallback(function () {\n    setActive(true);\n    setFocusItemValue(value);\n  });\n\n  // Find active `MenuItem` by `value`\n  var activeItem = data.find(function (item) {\n    return shallowEqual(item[valueKey], value);\n  });\n\n  /**\n   * 1.Have a value and the value is valid.\n   * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\n   */\n  var hasValue = !!activeItem || !isNil(value) && isFunction(renderValue);\n  var _useClassNames = useClassNames(classPrefix),\n    prefix = _useClassNames.prefix,\n    merge = _useClassNames.merge;\n  var selectedElement = placeholder;\n  if (activeItem !== null && activeItem !== void 0 && activeItem[labelKey]) {\n    selectedElement = activeItem[labelKey];\n  }\n  if (!isNil(value) && isFunction(renderValue)) {\n    selectedElement = renderValue(value, activeItem, selectedElement);\n    // If renderValue returns null or undefined, hasValue is false.\n    if (isNil(selectedElement)) {\n      hasValue = false;\n    }\n  }\n  var renderPopup = function renderPopup(positionProps, speakerRef) {\n    var left = positionProps.left,\n      top = positionProps.top,\n      className = positionProps.className;\n    var classes = merge(className, menuClassName, prefix('select-menu'));\n    var styles = _extends({}, menuStyle, {\n      left: left,\n      top: top\n    });\n    var items = filteredData;\n\n    // Create a tree structure data when set `groupBy`\n    if (groupBy) {\n      items = getDataGroupBy(items, groupBy, sort);\n    } else if (typeof sort === 'function') {\n      items = items.sort(sort(false));\n    }\n    var menu = items.length ? /*#__PURE__*/React.createElement(Listbox, {\n      listProps: listProps,\n      listRef: list,\n      disabledItemValues: disabledItemValues,\n      valueKey: valueKey,\n      labelKey: labelKey,\n      renderMenuGroup: renderMenuGroup,\n      renderMenuItem: renderMenuItem,\n      maxHeight: menuMaxHeight,\n      classPrefix: 'picker-select-menu',\n      listItemClassPrefix: 'picker-select-menu-item',\n      listItemAs: ListItem,\n      activeItemValues: [value],\n      focusItemValue: focusItemValue,\n      data: items,\n      query: searchKeyword,\n      groupBy: groupBy,\n      onSelect: handleItemSelect,\n      onGroupTitleClick: onGroupTitleClick,\n      virtualized: virtualized\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: prefix(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"none\"])))\n    }, locale === null || locale === void 0 ? void 0 : locale.noResultsText);\n    return /*#__PURE__*/React.createElement(PickerPopup, {\n      ref: mergeRefs(overlay, speakerRef),\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      onKeyDown: onPickerKeyDown,\n      target: trigger\n    }, searchable && /*#__PURE__*/React.createElement(SearchBox, {\n      placeholder: locale === null || locale === void 0 ? void 0 : locale.searchPlaceholder,\n      onChange: handleSearch,\n      value: searchKeyword,\n      inputRef: searchInput\n    }), renderMenu ? renderMenu(menu) : menu, renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n  var _usePickerClassName = usePickerClassName(_extends({}, props, {\n      classPrefix: classPrefix,\n      appearance: appearance,\n      hasValue: hasValue,\n      name: 'select',\n      cleanable: cleanable\n    })),\n    classes = _usePickerClassName[0],\n    usedClassNamePropKeys = _usePickerClassName[1];\n  return /*#__PURE__*/React.createElement(PickerToggleTrigger, {\n    id: id,\n    pickerProps: pick(props, pickTriggerPropKeys),\n    ref: trigger,\n    placement: placement,\n    onEntered: createChainedFunction(handleEntered, onEntered),\n    onExited: createChainedFunction(handleExited, onExited),\n    speaker: renderPopup\n  }, /*#__PURE__*/React.createElement(Component, {\n    className: classes,\n    style: style,\n    ref: root\n  }, /*#__PURE__*/React.createElement(PickerToggle, _extends({}, omit(rest, [].concat(omitTriggerPropKeys, usedClassNamePropKeys)), {\n    ref: target,\n    appearance: appearance,\n    onClean: createChainedFunction(handleClean, onClean),\n    onKeyDown: onPickerKeyDown,\n    as: toggleAs,\n    disabled: disabled,\n    cleanable: cleanable && !disabled,\n    hasValue: hasValue,\n    inputValue: value !== null && value !== void 0 ? value : '',\n    focusItemValue: focusItemValue,\n    active: active,\n    placement: placement\n  }), selectedElement || (locale === null || locale === void 0 ? void 0 : locale.placeholder))));\n});\nSelectPicker.displayName = 'SelectPicker';\nSelectPicker.propTypes = _extends({}, listPickerPropTypes, {\n  locale: PropTypes.any,\n  appearance: oneOf(['default', 'subtle']),\n  menuAutoWidth: PropTypes.bool,\n  menuMaxHeight: PropTypes.number,\n  renderMenu: PropTypes.func,\n  renderMenuItem: PropTypes.func,\n  renderMenuGroup: PropTypes.func,\n  onSelect: PropTypes.func,\n  onGroupTitleClick: PropTypes.func,\n  onSearch: PropTypes.func,\n  /**\n   * group by key in `data`\n   */\n  groupBy: PropTypes.any,\n  sort: PropTypes.func,\n  searchable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchBy: PropTypes.func\n});\nexport default SelectPicker;","map":null,"metadata":{},"sourceType":"module"}